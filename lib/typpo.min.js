function Typpo(a){this.self=this;this.q=[];this.onDrain=function(){};this.badness=this.speed=0;this.correctionSpeed=30;this.showCursor=!0;this.cursor="|";this.blinkToggle=!0;if(!1===a.showCursor)this.showCursor=!1;else{var b=document.createElement("style");b.type="text/css";b.innerHTML="\n.typpo-cursorBlink {\n    animation: typpoBlink 0.7s infinite;\n}\n@keyframes typpoBlink {\n    50% { opacity: 0.0; }\n    100% { opacity: 1; }\n}\n";b.innerHTML+="\n.typpo-cursorSolid {\n    opacity: 1;\n}";document.head.appendChild(b)}a.cursor&&
(this.cursor=a.cursor);this.destination=document.getElementById(a.element);this.showCursor&&this.insertCursor(this.self);a.speed&&(this.speed=100<a.speed?100:0>a.speed?0:a.speed);this.slowness=1E3-10*this.speed;a.badness&&(this.badness=100<a.badness?100:0>a.badness?0:a.badness);this.probability=this.badness/100;a.correctionSpeed&&(this.correctionSpeed=100<a.correctionSpeed?100:0>a.correctionSpeed?0:a.correctionSpeed);this.backspaceSlowness=1E3-10*this.correctionSpeed}
Typpo.prototype.pressKey=function(a){window.requestAnimationFrame(function(){this.self.showCursor?(this.self.removeCursor(this.self),this.self.destination.innerHTML+=this.c,this.self.insertCursor(this.self)):this.self.destination.innerHTML+=this.c}.bind({self:this.self,c:a}))};
Typpo.prototype.write=function(a){var b=this.q.length;this.q[b]=new Promise(function(b,f){function c(a,e,d,g){g||(g=!1);setTimeout(function(){var a=this.s.substr(this.pos,1);!this.forceCorrect&&this.self.errorTable.hasOwnProperty(a)&&this.self.probability>Math.random()?(this.self.pressKey(this.self.errorTable[a][Math.floor(Math.random()*this.self.errorTable[a].length)]),setTimeout(function(){window.requestAnimationFrame(function(){this.self.showCursor?(this.self.removeCursor(this.self),this.self.destination.innerHTML=
this.self.destination.innerHTML.substr(0,this.self.destination.innerHTML.length-1),this.self.insertCursor(this.self)):this.self.destination.innerHTML=this.self.destination.innerHTML.substr(0,this.self.destination.innerHTML.length-1);c(this.self,this.s,this.pos,!0)}.bind({self:this.self,s:this.s,pos:this.pos}))}.bind({self:this.self,s:this.s,pos:this.pos}),Math.random()*this.self.backspaceSlowness)):(this.self.pressKey(a),this.pos+=1,this.pos<=this.s.length?c(this.self,this.s,this.pos):(this.self.removeCursor(this.self),
this.self.blinkToggle=!0,this.self.insertCursor(this.self),b(),this.self.q.shift(),this.self.checkComplete(this.self)))}.bind({self:a,s:e,pos:d,forceCorrect:g}),Math.random()*a.slowness)}0===this.self.q.length?(this.self.blinkToggle=!1,c(this.self,this.s,0)):0<this.self.q.length&&this.self.q[this.self.q.length-1].then(function(){this.self.blinkToggle=!1;c(this.self,this.s,0)}.bind({self:this.self,s:a}))}.bind({self:this.self,s:a,taskIndex:b}))};
Typpo.prototype.writeUncorrected=function(a){var b=this.q.length;this.q[b]=new Promise(function(b,f){function c(a,e,d){setTimeout(function(){var a=this.s.substr(this.pos,1);this.self.errorTable.hasOwnProperty(a)&&this.self.probability>Math.random()?this.self.pressKey(this.self.errorTable[a][Math.floor(Math.random()*this.self.errorTable[a].length)]):this.self.pressKey(a);this.pos+=1;this.pos<=this.s.length?c(this.self,this.s,this.pos):(this.self.removeCursor(this.self),this.self.blinkToggle=!0,this.self.insertCursor(this.self),
b(),this.self.q.shift(),this.self.checkComplete(this.self))}.bind({self:a,s:e,pos:d}),Math.random()*a.slowness)}0===this.self.q.length?(this.self.blinkToggle=!1,c(this.self,this.s,0)):0<this.self.q.length&&this.self.q[this.self.q.length-1].then(function(){this.self.blinkToggle=!1;c(this.self,this.s,0)}.bind({self:this.self,s:a}))}.bind({self:this.self,s:a,taskIndex:b}))};
Typpo.prototype.enter=function(a){var b=this.q.length;a||(a=1);this.q[b]=new Promise(function(b,f){function c(a,e,d){d||(d=0);setTimeout(function(){this.self.showCursor?(this.self.removeCursor(this.self),this.self.destination.innerHTML+="<br>",this.self.insertCursor(this.self)):this.self.destination.innerHTML+="<br>";this.i+=1;this.i<this.n?c(this.self,this.n,this.i):(a.removeCursor(a),a.blinkToggle=!0,a.insertCursor(a),b(),a.q.shift(),a.checkComplete(a))}.bind({self:a,n:e,i:d}),Math.random()*a.slowness)}
0===this.self.q.length?(this.self.blinkToggle=!1,c(this.self,this.n)):0<this.self.q.length&&this.self.q[this.self.q.length-1].then(function(){this.self.blinkToggle=!1;c(this.self,this.n)}.bind({self:this.self,n:a}))}.bind({self:this.self,n:a,taskIndex:b}))};
Typpo.prototype.backspaceAll=function(a){var b=this.q.length;this.q[b]=new Promise(function(b,f){function c(a){setTimeout(function(){a.showCursor?(a.removeCursor(a),a.destination.innerHTML=a.destination.innerHTML.substr(0,a.destination.innerHTML.length-1),a.insertCursor(a)):a.destination.innerHTML=a.destination.innerHTML.substr(0,a.destination.innerHTML.length-1);a.showCursor&&a.destination.innerHTML.length>a.cursor.length+39?c(this.self):!a.showCursor&&0<a.destination.innerHTML.length?c(this.self):
(this.self.removeCursor(this.self),this.self.blinkToggle=!0,this.self.insertCursor(this.self),b(),a.q.shift(),a.checkComplete(a))}.bind({self:a}),100)}0===this.self.q.length?setTimeout(function(){this.self.blinkToggle=!1;c(this.self)}.bind({self:this.self}),a):0<this.self.q.length&&this.self.q[this.self.q.length-1].then(function(){setTimeout(function(){this.self.blinkToggle=!1;c(this.self)}.bind({self:this.self}),a)}.bind({self:this.self}))}.bind({self:this.self,ttl:a,taskIndex:b}))};
Typpo.prototype.pause=function(a){var b=this.q.length;this.q[b]=new Promise(function(a,b){function c(b,c){setTimeout(function(){a();b.q.shift();b.checkComplete(b)},c)}0===this.self.q.length?c(this.self,this.t):0<this.self.q.length&&this.self.q[this.self.q.length-1].then(function(){c(this.self,this.t)}.bind({self:this.self,t:this.t}))}.bind({self:this.self,t:a,taskIndex:b}))};
Typpo.prototype.insertCursor=function(a){a.destination.innerHTML=a.blinkToggle?a.destination.innerHTML+'<span class="typpo-cursorBlink">'+a.cursor+"</span>":a.destination.innerHTML+'<span class="typpo-cursorSolid">'+a.cursor+"</span>"};Typpo.prototype.removeCursor=function(a){a.destination.innerHTML=a.destination.innerHTML.substr(0,a.destination.innerHTML.length-(a.cursor.length+39))};Typpo.prototype.checkComplete=function(a){if(0===a.q.length)a.onDrain()};
Typpo.prototype.errorTable={1:["`","2","q"],2:["1","3","q","w"],3:["2","4","w","e"],4:["3","5","e","r"],5:["4","6","r","t"],6:["5","7","t","y"],7:["6","8","y","u"],8:["7","9","i","u"],9:["8","0","o","i"],0:["9","-","o","p"],a:["s","z","q"],b:["v","g","n"],c:["x","d","v"],d:["s","f","c","e"],e:["w","r","d"],f:["d","g","v","r"],g:["f","h","t","b"],h:["g","j","y","n"],i:["o","u","k"],j:["h","k","u","m"],k:["l","j","i",","],l:["k",";","o","."],m:["n",",","j"],n:["b","m","h"],o:["i","p","l"],p:["o","[",
";"],q:["w","a"],r:["e","t","f"],s:["a","d","w","x"],t:["r","y","g"],u:["y","i","j"],v:["c","b","f"],w:["q","e","s"],x:["z","c","s"],y:["t","u","h"],z:["x","a"],A:["s","z","q","a"],B:["v","n","g","b"],C:["x","v","d","c"],D:["s","f","c","e","d"],E:["w","r","d","e"],F:["d","g","r","v","f"],G:["f","h","t","b","g"],H:["g","j","y","n","h"],I:["u","o","k","i"],J:["h","k","u","m","j"],K:["j","l","i",",","k"],L:["k",";","o",".","l"],M:["m",",","j","m"],N:["b","m","h","n"],O:["i","p","l","o"],P:["o","[",";",
"p"],Q:["a","s","w","q"],R:["e","t","f","r"],S:["a","d","w","x","s"],T:["r","y","g","t"],U:["y","i","j","u"],V:["c","b","f","v"],W:["e","q","s","w"],X:["z","c","s","x"],Y:["t","u","h","y"],Z:["x","s","a","z"],"!":["1","@","~"],"@":["2","!","#"],"#":["3","@","$"],$:["4","#","%"],"%":["5","$","^"],"^":["6","%","&"],"&":["7","^","*"],"*":["8,","&","("],"(":["9","*",")"],")":["0","(","_"],_:["-",")","+"],"+":["=","_"],"=":["-","[","]"],"[":["p","'","]"],"]":["[","'"],";":["p","l","'","."],"'":[";","[",
"]"],",":["k","l","m","."],".":[",","/","l",";"],"/":[".",";","'"],"{":["P",'"',"}","["],"}":["{",'"',"]"],":":["P","L",'"',">",";"],'"':[":","{","}"],"<":["K","L","M",">",","],">":["<","?","L",";","."],"?":[">",":","/"]};